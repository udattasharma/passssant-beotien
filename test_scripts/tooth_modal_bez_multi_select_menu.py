import bpy
import bgl
import blf

from mathutils import Vector
from mathutils.geometry import intersect_line_line_2d
from math import fmod


#hardcode some button data...easily generated form bezier button data script

button_data = [

    [(0.40504742345665645,1.6772808403314567),
    (0.4317544069251058,1.6803653284947315),
    (0.45551241603154824,1.6769254662761848),
    (0.47799768603190873,1.667164081753596),
    (0.4858512897677413,1.6571539778842326),
    (0.48581120572723036,1.6442629221279697),
    (0.4804378905228368,1.6324225498081384),
    (0.4639553826386389,1.6070339134353275),
    (0.44812994141143836,1.58394947201316),
    (0.431852704890175,1.5710402863728496),
    (0.41282854306622935,1.5703425691164647),
    (0.39716924522955654,1.5784184409815263),
    (0.38388563499175266,1.5910814567900062),
    (0.37304580564778467,1.5997532069534053),
    (0.3613693813028347,1.6075402754311814),
    (0.35190529855067865,1.6178951303768827),
    (0.34844128676002184,1.6272398108458206),
    (0.34918588676343537,1.6364863349894085),
    (0.3550892886166353,1.6449004425037284),
    (0.3853830501022886,1.66973045182433)],

    [(0.27271350470275735,1.6328630493346012),
    (0.2880053182881735,1.639765152847316),
    (0.3027180732918976,1.641983089209015),
    (0.3214008833927642,1.6394689841946362),
    (0.33046614410580827,1.6330848571347432),
    (0.3341434653134597,1.6221004136375536),
    (0.33473810426425493,1.6104727841758406),
    (0.33363292494589186,1.5879456950484099),
    (0.32976453175714765,1.5704873249094053),
    (0.32105025426808276,1.558557011367933),
    (0.30755337002321403,1.551817510252768),
    (0.29519665010733104,1.5526367543881578),
    (0.28192791204003476,1.5588599787271304),
    (0.27084812730691266,1.5638091537926195),
    (0.25977747833567383,1.568193328018539),
    (0.2492498583425759,1.5749526586943805),
    (0.24341040682255863,1.581990453058012),
    (0.24097887776442664,1.5900860128440313),
    (0.2429579564447949,1.5988700833046925),
    (0.2599006340714486,1.6239553273991485)],

    [(0.1402417173872599,1.5727182921252636),
    (0.152678251284867,1.5819676490632337),
    (0.16669649363085134,1.5858879532090355),
    (0.1828397389778272,1.5873156815777645),
    (0.19903705528757715,1.5878108540358078),
    (0.21337214568523277,1.5859519743620776),
    (0.22658351966628548,1.5780950775027756),
    (0.23660568061673898,1.5635461288342136),
    (0.2400013158329906,1.547140991646585),
    (0.24102229033833691,1.528315514938635),
    (0.24378104255756575,1.5100852083304268),
    (0.24212633653894705,1.4933099665567378),
    (0.2330254357315794,1.4781675474650633),
    (0.21804919544036247,1.4681167929963124),
    (0.20186058997333844,1.4665370852089679),
    (0.18329932445644165,1.4706357137611414),
    (0.16906486907922072,1.4725700874051624),
    (0.15628406213932772,1.4763133419020642),
    (0.14563075460047578,1.4846141376410882),
    (0.13568272433801667,1.5016825736333554),
    (0.13197530469005228,1.519542350736346),
    (0.1314983771983281,1.539994984537546),
    (0.13400716187075756,1.5628348141647934)],

    [(0.07358171900053631,1.4489151211943798),
    (0.08108866837630528,1.458844773703283),
    (0.08983060102052834,1.466225477826904),
    (0.1009399707499816,1.4730672428192735),
    (0.10880443648177418,1.477517704433741),
    (0.11641706679297152,1.480539587841165),
    (0.12561151178233543,1.4813894261558844),
    (0.13883190644299961,1.4786427487227107),
    (0.14999872878352088,1.4729587467944276),
    (0.1622584963116663,1.466075481364356),
    (0.17489286548695415,1.4598062241166692),
    (0.18583602100602017,1.453709908966028),
    (0.19717231527046847,1.4456646312802963),
    (0.20706234406794796,1.4385157913768747),
    (0.2151598336951402,1.4314403208479574),
    (0.21942881941948536,1.4218739742185966),
    (0.21810342574782052,1.4086571471083578),
    (0.21096545669284145,1.3982197162064096),
    (0.1997742900255964,1.3891220554076167),
    (0.18550929358394025,1.381800556686588),
    (0.1705879740938121,1.3788426944322063),
    (0.15325630068356036,1.378036906070133),
    (0.1341836626657459,1.3776533457107563),
    (0.11712780605103293,1.3797088213146247),
    (0.10033084913790631,1.3874988642265023),
    (0.08462741282376272,1.4018629730616126),
    (0.07564388708113329,1.4184597487892106),
    (0.07092785984579825,1.4381837878752575),
    (0.07173550280294382,1.445463502879146)],

    [(0.048974920598543956,1.349719301945641),
    (0.06218571474199652,1.3621183013176814),
    (0.07836274116198251,1.369094907322653),
    (0.09832769170528768,1.3719282682639282),
    (0.11282076350465672,1.3706246162891484),
    (0.12539606891707156,1.365994980429994),
    (0.13893421458261643,1.3596046212224597),
    (0.15791530907946716,1.3515446130059396),
    (0.17395814957055192,1.3429924067654777),
    (0.18721190923755127,1.3296825223597772),
    (0.1918729891143502,1.3203936479401726),
    (0.1929233184514841,1.3113063268408756),
    (0.19128815871410398,1.3013872973109062),
    (0.18855525574361454,1.2935275676572215),
    (0.18416405264663374,1.2872590186081305),
    (0.17717962104718069,1.2819609849144493),
    (0.15886009912089183,1.2743387850697288),
    (0.1401615227487907,1.2719609374651433),
    (0.11878126386962687,1.2724402462746451),
    (0.09968313070237082,1.273780582936677),
    (0.08295998578787057,1.277442536234804),
    (0.06664522801976412,1.2858616011392932),
    (0.05608713778209055,1.2952306436399197),
    (0.049641543510340724,1.3057211894365381),
    (0.04554049823045958,1.3183364726596745),
    (0.04395437239334228,1.3398406397356208)],

    [(0.024027850476330832,1.1980785438983628),
    (0.020665801578475522,1.2182614956743583),
    (0.022915407696121614,1.2382526672706655),
    (0.03460759831230609,1.2570802685744025),
    (0.04433578602572616,1.263448390346035),
    (0.05563916233420274,1.2659505976240077),
    (0.06871099463447498,1.2670522713593226),
    (0.08372798290238623,1.2672682719309807),
    (0.09707294969601638,1.2654671812626515),
    (0.1118119611626723,1.2623918996811194),
    (0.13109570432935258,1.25866436719304),
    (0.14787080446332249,1.2541988917683458),
    (0.16426802753164532,1.2456513596386147),
    (0.17518414756932432,1.2368096418122716),
    (0.18251736697711024,1.2271267256940752),
    (0.18693820818531687,1.21503111860039),
    (0.1899168383635145,1.2004957673448635),
    (0.1879610771219064,1.1876886331221792),
    (0.17724024284696402,1.168570741214106),
    (0.17682978864591933,1.1572115898399846),
    (0.17641936985480441,1.1458524384658633),
    (0.17119507733988992,1.1347717507795319),
    (0.1609132553743598,1.1261356230054913),
    (0.14871352538215635,1.1213542201873001),
    (0.1340412793381006,1.1186139165414866),
    (0.11156453427833465,1.117055737991448),
    (0.09143532592326258,1.119536203572536),
    (0.07012416066958194,1.126030597153764),
    (0.05183295340839341,1.1335382104657163),
    (0.03734896425601294,1.1428089550012737),
    (0.026043388105648782,1.1564920600668553),
    (0.020461388906338116,1.1835491415110393)],

    [(0.023295387226349405,1.0600402270966272),
    (0.021728710293163766,1.0756232165346242),
    (0.022106932605626226,1.08951488608661),
    (0.03011004149123112,1.1019772692329564),
    (0.050820335646475194,1.1123365150099505),
    (0.07421690232092969,1.1136613421227388),
    (0.10047801280607192,1.111635823319464),
    (0.11797685649481496,1.1098561910685818),
    (0.13305962755977496,1.1060135763087173),
    (0.14803200816864587,1.0985499421295517),
    (0.1616382382766752,1.0887484735664519),
    (0.17112466469452242,1.077800289837357),
    (0.17691994232713917,1.0637788783026576),
    (0.1787277608821265,1.051003613016775),
    (0.17648000935955263,1.0395179773734797),
    (0.16892021951606948,1.0290078144757633),
    (0.1655078708129617,1.0180040371569141),
    (0.1610975817638295,1.0109755910147444),
    (0.1532901879863598,1.005140671965739),
    (0.13509187424970784,0.9975052996271405),
    (0.116487081076629,0.9954563394503515),
    (0.09558930019568235,0.9968539693787675),
    (0.07125355595367333,1.0003079247493667),
    (0.05071572143518145,1.0071142798119563),
    (0.03292468385837643,1.0204085130286942),
    (0.02345569683094584,1.0454875957953682)],

    [(0.03633534616357843,0.9394170803195647),
    (0.03405785915247183,0.9545988044332948),
    (0.03289527591169415,0.968198129605017),
    (0.03975668898885033,0.9804217081849274),
    (0.059050462018140785,0.989666815931324),
    (0.08105718009624843,0.9898550551180344),
    (0.10555802756209785,0.9868652531069911),
    (0.12408082019028871,0.984507305882942),
    (0.13995521564541005,0.980090696161344),
    (0.15499607905847546,0.9713421064503224),
    (0.16609700351967618,0.9610541762719051),
    (0.17275750508150198,0.949798492712601),
    (0.1751890872545286,0.936195272448603),
    (0.17355344948309645,0.9257913393402266),
    (0.16854510442494522,0.917090057295391),
    (0.16091472488644565,0.9083707161863676),
    (0.15460954426499715,0.9027620665886562),
    (0.14786386411708563,0.8987341162563234),
    (0.13974226032771322,0.8949451829500055),
    (0.12579474931646442,0.8885388184542107),
    (0.11273490327742271,0.8839893506760782),
    (0.09740070400605991,0.8823885385705846),
    (0.07597234958977242,0.8838053606809414),
    (0.057692469079872265,0.8890297417206804),
    (0.042193772979716555,0.9004626873884631),
    (0.035588479924659,0.9251926990673661)],

    [(0.5929508178029512,1.6808847213447444),
    (0.5662438343345019,1.6839692095080194),
    (0.5424858252280594,1.6805293472894725),
    (0.520000555227699,1.6707679627668837),
    (0.5121469869017962,1.6607578588975203),
    (0.5121870355323773,1.6478668031412573),
    (0.5175603507367709,1.636026430821426),
    (0.5340428586209688,1.6106377944486152),
    (0.5498682998481693,1.5875533530264476),
    (0.5661455363694327,1.5746441673861373),
    (0.5851696981933783,1.5739464501297526),
    (0.6008289606201214,1.5820223219948142),
    (0.6141125708579253,1.594685337803294),
    (0.6249524002018932,1.6033570879666932),
    (0.6366288953667028,1.611144156444469),
    (0.6460929781188588,1.6214990113901704),
    (0.649556919089656,1.6308436918591083),
    (0.6488123190862425,1.6400902160026962),
    (0.6429089880529021,1.6485043235170163),
    (0.6126151557473892,1.6733343328376178)],

    [(0.7240853314153427,1.6356738895605365),
    (0.7087935532398563,1.642575993073251),
    (0.6940807982361322,1.6447939294349503),
    (0.6753979527253359,1.6422798244205714),
    (0.6663327274222215,1.6358956973606784),
    (0.6626554062145701,1.624911253863489),
    (0.6620607318538451,1.6132836244017756),
    (0.6631659465821379,1.5907565352743451),
    (0.6670343397708821,1.5732981651353406),
    (0.6757485818500173,1.5613678515938683),
    (0.6892454306849563,1.5546283504787033),
    (0.7016022214206987,1.5554475946140929),
    (0.7148709594879951,1.5616708189530657),
    (0.7259507265161522,1.5666199940185546),
    (0.7370213577824262,1.571004168244474),
    (0.7475490131854539,1.5777634989203158),
    (0.7533884647054712,1.5848012932839473),
    (0.7558199937636031,1.5928968530699665),
    (0.7538408619683402,1.6016809235306277),
    (0.7368982020466515,1.6267661676250835)],

    [(0.847211181209395,1.5681145763347082),
    (0.8353346199413285,1.5778697287096557),
    (0.821563627430033,1.5823689143875006),
    (0.8055229292396999,1.5844673068262625),
    (0.7893732392855041,1.5856366843473166),
    (0.7749446843781942,1.5843776488840595),
    (0.761284666586829,1.5770816453124723),
    (0.7504153053614245,1.5629699384568339),
    (0.7460554931671937,1.5467283951447888),
    (0.7439246652327534,1.527970763862297),
    (0.740093310830559,1.5098798307377028),
    (0.7407561847160403,1.4930582727758615),
    (0.7489531585409493,1.4775570802756564),
    (0.763319321151987,1.4668957169777794),
    (0.7793963499302743,1.4646436454437723),
    (0.7981784140643142,1.4679633971805055),
    (0.8125108664222012,1.469302034165908),
    (0.825498024727887,1.4725077659287495),
    (0.8366291361542252,1.4803534732502412),
    (0.8475730706917464,1.4969845257898662),
    (0.8523302531179682,1.5146658368467656),
    (0.8540135703598492,1.5350710213420604),
    (0.8528554531964649,1.5579846452629693)],

    [(0.9244164425867293,1.4489151211943798),
    (0.9169095374733726,1.458844773703283),
    (0.9081676048291495,1.466225477826904),
    (0.8970581642798368,1.4730672428192735),
    (0.8891937605154212,1.477517704433741),
    (0.8815811213517415,1.480539587841165),
    (0.8723866498049302,1.4813894261558844),
    (0.8591662817017134,1.4786427487227107),
    (0.847999477066157,1.4729587467944276),
    (0.8357397095380116,1.466075481364356),
    (0.8231053049527939,1.4598062241166692),
    (0.8121621494337279,1.453709908966028),
    (0.8008258728742446,1.4456646312802963),
    (0.7909358086668352,1.4385157913768747),
    (0.7828383367446079,1.4314403208479574),
    (0.7785693864301925,1.4218739742185966),
    (0.7798947801018573,1.4086571471083578),
    (0.7870327137469066,1.3982197162064096),
    (0.7982238804141517,1.3891220554076167),
    (0.8124889122657376,1.381800556686588),
    (0.8274101609360063,1.3788426944322063),
    (0.8447419051661175,1.378036906070133),
    (0.8638144723640724,1.3776533457107563),
    (0.8808703732411977,1.3797088213146247),
    (0.8976673567117716,1.3874988642265023),
    (0.9133707399110205,1.4018629730616126),
    (0.9223543099160622,1.4184597487892106),
    (0.9270703460038796,1.4381837878752575),
    (0.9262626455055982,1.445463502879146)],

    [(0.9508083130900666,1.349719301945641),
    (0.93759757648775,1.3621183013176814),
    (0.9214204792479044,1.369094907322653),
    (0.9014555818194939,1.3719282682639282),
    (0.8869625100201248,1.3706246162891484),
    (0.8743871691977803,1.365994980429994),
    (0.8608490323847178,1.3596046212224597),
    (0.8418679644453144,1.3515446130059396),
    (0.8258251416591945,1.3429924067654777),
    (0.8125713465822654,1.3296825223597772),
    (0.8079102667054665,1.3203936479401726),
    (0.8068599373683326,1.3113063268408756),
    (0.8084950971057127,1.3013872973109062),
    (0.8112279646662723,1.2935275676572215),
    (0.8156192208781479,1.2872590186081305),
    (0.8226036170676712,1.2819609849144493),
    (0.8409231566989248,1.2743387850697288),
    (0.8596217242185435,1.2719609374651433),
    (0.88100195654026,1.2724402462746451),
    (0.9001001605273756,1.273780582936677),
    (0.9168232788844285,1.277442536234804),
    (0.9331380499312587,1.2858616011392932),
    (0.9436960870540376,1.2952306436399197),
    (0.9501416857520286,1.3057211894365381),
    (0.9542427929992869,1.3183364726596745),
    (0.9558288745739919,1.3398406397356208)],

    [(0.9689127728078367,1.2000809046075613),
    (0.9722748040007272,1.2202638563835568),
    (0.9700252111618047,1.240255027979864),
    (0.9583330648080325,1.259082629283601),
    (0.9486048239797177,1.2654507510552335),
    (0.9373014786549297,1.2679529583332063),
    (0.9242296197972102,1.2690546320685212),
    (0.909212693496676,1.2692706326401793),
    (0.8958676824406336,1.26746954197185),
    (0.8811286532690128,1.264394260390318),
    (0.8618449012498501,1.2606667279022385),
    (0.8450698719357397,1.2562012524775443),
    (0.8286725957525223,1.2476537203478133),
    (0.8177564934198082,1.2388121441611895),
    (0.8104232386020924,1.2291290864032738),
    (0.8060024505087805,1.2170334793095885),
    (0.8030238380355477,1.202498128054062),
    (0.8049795284572963,1.1896910646512373),
    (0.8157003804372035,1.1705731019233045),
    (0.8161108523432131,1.1592139505491832),
    (0.8165212534293631,1.1478547991750618),
    (0.8217455636492426,1.1367741114887304),
    (0.8320274033197376,1.1281379837146899),
    (0.844227115606976,1.1233565808964987),
    (0.8588993616510319,1.1206162772506851),
    (0.8813760978583154,1.1190580987006467),
    (0.901505297360905,1.1215385642817346),
    (0.9228164803195505,1.1280329578629626),
    (0.9411076920069803,1.135540571174915),
    (0.9555916988643256,1.1448113157104722),
    (0.96689723960476,1.158494420776054),
    (0.9724792609352768,1.1855515022202379)],

    [(0.9693478900249731,1.0603167078283493),
    (0.9709145669581588,1.0758996972663464),
    (0.970536318088249,1.089791366818332),
    (0.9625332490388151,1.1022537499646785),
    (0.9418229017686763,1.1126129957416726),
    (0.918426357225428,1.113937822854461),
    (0.8921652201828384,1.1119123040511862),
    (0.8746664119040252,1.1101326718003037),
    (0.8595836231341003,1.1062900570404395),
    (0.8446112425252293,1.0988264228612739),
    (0.8310050478271298,1.089024954298174),
    (0.8215185859993528,1.0780767705690792),
    (0.815723326071701,1.0640553590343798),
    (0.8139155075167136,1.0512800937484972),
    (0.8161632590392875,1.0397944581052019),
    (0.8237230665877355,1.0292842952074854),
    (0.8271353798809136,1.0182805178886363),
    (0.8315456866350106,1.0112520717464666),
    (0.8393530804124804,1.0054171526974611),
    (0.8575513764441675,0.9977817803588626),
    (0.8761561784697287,0.9957328201820735),
    (0.8970539859081227,0.9971304501104896),
    (0.9213897434288554,1.0005844054810888),
    (0.941927573521106,1.0073907605436783),
    (0.9597185845404637,1.0206849937604163),
    (0.9691875538629294,1.0457640765270904)],

    [(0.9616628729648231,0.9381918967491772),
    (0.9639403688284122,0.9533736208629073),
    (0.9651029476429486,0.9669729460346296),
    (0.9582414947296214,0.9791965246145399),
    (0.9389477571102608,0.9884416323609365),
    (0.9169410523108767,0.9886298715476469),
    (0.8924401428776503,0.9856400695366037),
    (0.8739173502494594,0.9832821223125545),
    (0.8580430079092327,0.9788655125909566),
    (0.8430021444961673,0.9701169228799349),
    (0.8319012023300016,0.9598289927015177),
    (0.8252406653582461,0.9485733091422135),
    (0.8228091363001141,0.9349700888782155),
    (0.8244447917765112,0.9245661557698391),
    (0.8294531014247326,0.9158648737250035),
    (0.837083516373162,0.9071455326159801),
    (0.8433886792896457,0.9015368830182687),
    (0.8501343417325923,0.8975089326859359),
    (0.8582559632269295,0.893719999379618),
    (0.8722034388282486,0.8873136348838232),
    (0.8852633291297025,0.8827641671056907),
    (0.9005975284010653,0.8811633550001972),
    (0.922025847407423,0.8825801771105539),
    (0.9403057279173231,0.8878045581502929),
    (0.9558044417224437,0.8992375038180757),
    (0.9624097392037425,0.9239675154969786)],

    [(0.549915501284566,0.028264907509617514),
    (0.5607402459984477,0.028074835859041),
    (0.5702375432647374,0.02945633656444221),
    (0.5794759231244758,0.03368595751247509),
    (0.5865153109349475,0.0394024347726077),
    (0.5908378364731199,0.04607999064186376),
    (0.5927406244597773,0.05438292425539822),
    (0.5916234411752187,0.0674776225178259),
    (0.5863327019270721,0.07871935456479673),
    (0.5776908023344776,0.09003279171957206),
    (0.570385521361288,0.09852152566090332),
    (0.5623760431145639,0.10487624477411403),
    (0.5517108555442708,0.10766389149604333),
    (0.5397235674257823,0.10561221360714368),
    (0.5304670576819965,0.09937931350485855),
    (0.5220474970384905,0.09059504828958354),
    (0.5145436371790948,0.08094653291816843),
    (0.5102094971839545,0.07110846819264106),
    (0.508849295551316,0.05946680754625262),
    (0.5096318195895239,0.050979928199993585),
    (0.512508663924569,0.04369368449030203),
    (0.5184045588726555,0.03707854526164503),
    (0.538143328489491,0.02906384626339903)],

    [(0.663248664178104,0.040618562253453935),
    (0.6723815932669577,0.042645293846823584),
    (0.6802041424943731,0.045395720306312885),
    (0.6873228839574818,0.050524658306571095),
    (0.6952695095788464,0.060116615167645125),
    (0.6993674299324244,0.07022052879347816),
    (0.6993045418971351,0.08171253822413395),
    (0.6943091922832131,0.0936736052896203),
    (0.6853532420233999,0.10248471123166854),
    (0.6736761802997139,0.11087875902076813),
    (0.6670162807066944,0.11589023785770491),
    (0.6604019891032314,0.11951322252810893),
    (0.6522876620544289,0.12018965841669597),
    (0.6390569542517163,0.11541447889366348),
    (0.6296090892473994,0.10651529960376996),
    (0.6214388145095445,0.09491395316243603),
    (0.6138686672616007,0.08245464182749797),
    (0.6098278985346876,0.07038001511720722),
    (0.6107414039031516,0.057002860697407065),
    (0.6142884165692126,0.04902973074360215),
    (0.6201819036420742,0.04320531073877649),
    (0.6286368742153602,0.03898162316710236),
    (0.6511341481819161,0.03788430485315042)],

    [(0.8026107457947345,0.08560727640063445),
    (0.8063133496922488,0.09606588244059117),
    (0.8056492010492954,0.10663976550694661),
    (0.8032536484798198,0.11834508435459702),
    (0.8006201411822228,0.13275588118212225),
    (0.7964911309102979,0.14514921496539776),
    (0.787684468914437,0.15604637298567958),
    (0.772352889977878,0.16508551887551093),
    (0.756148031353085,0.1680237640287945),
    (0.7378189310407905,0.16744036773070436),
    (0.7251071203490739,0.16611161011571043),
    (0.7142887494225525,0.16261029396403046),
    (0.7054357712385395,0.15459858489173023),
    (0.7006726399441147,0.14350266208311094),
    (0.7008270272379553,0.13200996215882443),
    (0.7038884989468732,0.11948120309910538),
    (0.7104165319613921,0.10137842535299982),
    (0.719874524205626,0.08684674787768815),
    (0.7346200688043263,0.07503547366765359),
    (0.7473178571638501,0.0699367005013267),
    (0.7598488647541103,0.06920473741660342),
    (0.7736981840300792,0.07116251259796777),
    (0.7949038453979803,0.07763474841563581)],

    [(0.8761497338625087,0.19621245830392242),
    (0.8766746506615672,0.20749227373037166),
    (0.8735310987354193,0.21763672287332034),
    (0.8670638999802625,0.2278765309571665),
    (0.8567983488774662,0.2394718488579554),
    (0.8450423938302305,0.2475852729535486),
    (0.830055141050852,0.25265590407818284),
    (0.8113599020646326,0.2544891469627522),
    (0.7948264392914812,0.25140559716261646),
    (0.7783849715158984,0.24373534604318467),
    (0.7702003911664123,0.23825548236008315),
    (0.7645509493295944,0.23172713065619627),
    (0.7620583027326622,0.22302147548503282),
    (0.7641809863832532,0.2097492672446181),
    (0.7714154474968826,0.19865175984164113),
    (0.7818804273241997,0.18705484849401213),
    (0.7883065505608118,0.17595098500863968),
    (0.8012285545957025,0.16678418632195147),
    (0.817628097014426,0.16102495599785074),
    (0.8310008694554158,0.16020459644967297),
    (0.8426698577151119,0.16330147808837087),
    (0.8542839605836491,0.16942872381267496),
    (0.8719617306475704,0.1850789567073241)],

    [(0.927689099116855,0.31514154092541585),
    (0.9250009897075373,0.32789042581361216),
    (0.9172514557553281,0.3380096630865575),
    (0.9055729068145913,0.3468618976620452),
    (0.8897453055816743,0.3546461687553686),
    (0.8735997231793329,0.3579095124739622),
    (0.8550802590845414,0.35859409264639863),
    (0.834382730208983,0.3592713429633706),
    (0.8160883316278731,0.35731250105787166),
    (0.8035976205377026,0.3468618976620452),
    (0.8000006090507922,0.3361451886439222),
    (0.8002159014238545,0.3270185271126396),
    (0.80211252808273,0.3173141525769966),
    (0.79774131389111,0.30910949479732525),
    (0.7933455960280823,0.30124144381014245),
    (0.791551941445007,0.29312571806911353),
    (0.7961579942909278,0.2811292410738472),
    (0.8069668753562681,0.2729660483219482),
    (0.8214185175377946,0.2673437304913418),
    (0.8478637153953805,0.26216061972476146),
    (0.8724639850915697,0.2642185563187497),
    (0.8971574537229398,0.2738616008560138),
    (0.9238003098085577,0.29811871292270514)],

    [(0.949085195087113,0.44322279793259833),
    (0.9546546813024877,0.45517410956243026),
    (0.9565993238261449,0.468662141324854),
    (0.9543684982500058,0.4834788598824121),
    (0.9494531750773866,0.4950136090983123),
    (0.9419997389579976,0.5041055334884808),
    (0.9313502733965268,0.5121832466698908),
    (0.9222262676099777,0.5240325777019564),
    (0.9128710349819653,0.5322964408842199),
    (0.8999481102889004,0.5380212350516096),
    (0.8842780832435042,0.5416535856484405),
    (0.8698925159909472,0.5407467727567048),
    (0.8513739017344704,0.5341021702533503),
    (0.8317187703717752,0.5313448698412424),
    (0.8121680274820714,0.5237193414631227),
    (0.7967403459960894,0.5094214137867712),
    (0.7924298952439719,0.4931075633981153),
    (0.7961187600887316,0.47686386008035364),
    (0.7990730813501353,0.4586921214960015),
    (0.7964909184507193,0.4437247336872296),
    (0.7933449586493463,0.43040978566157045),
    (0.7957174239446052,0.41619489427055295),
    (0.8056054343760872,0.4014088761221141),
    (0.8192423648932359,0.3911146429761961),
    (0.837087694744876,0.3833102236328279),
    (0.8618817983966809,0.37674717019775666),
    (0.8852022824107618,0.3760168403960445),
    (0.9103553719306761,0.38083375937380515),
    (0.9226205925880077,0.3852803613059267),
    (0.9321823359264969,0.3915806022421709),
    (0.9402169198134349,0.40076852295197285),
    (0.9503229845925022,0.42755135449001097)],

    [(0.9528530948951416,0.6324195753740368),
    (0.9521388766114793,0.6444267284631319),
    (0.9507469830916877,0.6562833893506619),
    (0.9465327057088526,0.6673970082716888),
    (0.9387698576230461,0.6767576232090277),
    (0.9295027957201859,0.6817476613334827),
    (0.9166602515677215,0.6861522316789554),
    (0.8903212834994755,0.6912807226288502),
    (0.8652183344401296,0.6909886615280249),
    (0.8384016155992922,0.6848346990117018),
    (0.824678993052076,0.6777491720627268),
    (0.8152247542603988,0.6685510178832185),
    (0.80857923109887,0.6558459350781599),
    (0.8060288663163964,0.6442962782818223),
    (0.8072553246442559,0.6335849161630961),
    (0.8112812212006615,0.6223773192884332),
    (0.8114762590938897,0.6074424023852695),
    (0.8126706360253685,0.5941513560622118),
    (0.8196434177579239,0.5814599414900484),
    (0.832218050381673,0.5717199445650467),
    (0.8468495750064817,0.5668935003161752),
    (0.8641209098963883,0.5644000747007879),
    (0.8877437238909309,0.5628790057571589),
    (0.9088019383112281,0.5653057898847003),
    (0.9304706199209324,0.5730966472249628),
    (0.940374635640675,0.5788712631635529),
    (0.9475415346082844,0.5858931584687131),
    (0.9528511827589334,0.5951975778474913),
    (0.9558730661663574,0.6201173159301554)],

    [(0.9512442093256582,0.7817224282175215),
    (0.9507687247885726,0.7915629893430983),
    (0.9498258291783912,0.8002835343897343),
    (0.9461477997721441,0.8093064802366913),
    (0.9388666683710646,0.8194864101292795),
    (0.9300566070219448,0.8270513875274754),
    (0.918127639057804,0.8326965093528601),
    (0.8938407472401677,0.8389518150882136),
    (0.8709393043351031,0.8391757474841421),
    (0.8469783963310213,0.8326965093528601),
    (0.8343034119662759,0.8259006356294855),
    (0.8254323038982154,0.8169038223107061),
    (0.8192329458519144,0.8049660726839799),
    (0.8176181822340876,0.7946270813868199),
    (0.8194592153032084,0.7850552108084137),
    (0.8217052671491529,0.7743420781931984),
    (0.8216903949786453,0.7598933396259139),
    (0.8218380543858278,0.7469927940084699),
    (0.8280235317396551,0.7347961269751924),
    (0.8399381940921647,0.7263377570486474),
    (0.8538713640818527,0.7228319615408503),
    (0.8700537728111652,0.7212926210734548),
    (0.8917066615921876,0.7201845027309199),
    (0.9109560659794638,0.7222632072487242),
    (0.9307641682388085,0.7292500821333321),
    (0.9398263482879617,0.7345338810352419),
    (0.9463841256434957,0.7409589419739605),
    (0.9512424388291693,0.7494725513909622),
    (0.9528883631852024,0.7703988284128993)],

    [(0.44893208255074435,0.02826489644401446),
    (0.43810730242693285,0.028074824793437946),
    (0.42861004057057295,0.029456327711959766),
    (0.4193716607108345,0.03368595087311326),
    (0.41233223749043313,0.03940243034636648),
    (0.40800974736219037,0.04607999064186376),
    (0.40610695937553315,0.05438292868163945),
    (0.40722414266009166,0.06747763137030834),
    (0.41251488190823826,0.07871937226976163),
    (0.42115678150083286,0.09003280942453694),
    (0.42846206247402235,0.09852154336586821),
    (0.43647154072074645,0.10487627133156137),
    (0.44713672829103956,0.10766391805349067),
    (0.459124016409528,0.10561224016459102),
    (0.46838052615331377,0.09937933120982345),
    (0.47680008679681984,0.09059506599454843),
    (0.4843039466562155,0.08094655062313331),
    (0.4886380866513559,0.0711084770451235),
    (0.48999828828399444,0.05946680754625262),
    (0.4892157996557163,0.05097992377375236),
    (0.48633895532067123,0.04369367563781959),
    (0.48044306037258466,0.03707853640916259),
    (0.4607042553458194,0.02906383519779597)],

    [(0.33559899047706593,0.040618562253453935),
    (0.3264660967981421,0.042645293846823584),
    (0.3186435121607968,0.04539572473255411),
    (0.311524806107618,0.050524658306571095),
    (0.30357814507632364,0.060116615167645125),
    (0.29948022472274555,0.07022052879347816),
    (0.29954307734810504,0.08171253822413395),
    (0.3045384623719568,0.0936736052896203),
    (0.3134944126317701,0.10248471123166854),
    (0.32517147435545607,0.11087875902076813),
    (0.3318313385385458,0.11589023785770491),
    (0.33844566555193845,0.11951322252810893),
    (0.34655999260074105,0.12018965841669597),
    (0.3597907004034536,0.11541447889366348),
    (0.36923856540777045,0.10651529960376996),
    (0.37740887555555525,0.09491394430995359),
    (0.38497895198363946,0.08245464182749797),
    (0.3890197561204824,0.07038001511720722),
    (0.3881062153420886,0.057002860697407065),
    (0.3845592380859573,0.04902973074360215),
    (0.37866571560316603,0.04320530631253526),
    (0.3702107804398097,0.03898161874086114),
    (0.34771350647325383,0.03788430485315042)],

    [(0.19623690886043552,0.08560727640063445),
    (0.1925342695529914,0.09606588244059117),
    (0.1931984536058746,0.10663976550694661),
    (0.1955940061753501,0.11834508435459702),
    (0.198227531177912,0.13275588118212225),
    (0.20235648833494224,0.14514921496539776),
    (0.2111631503308031,0.15604637298567958),
    (0.22649480008722173,0.16508551887551093),
    (0.24269958789215523,0.1680237640287945),
    (0.26102870590941446,0.16744036773070436),
    (0.2737405520110609,0.16611161011571043),
    (0.2845589052326174,0.16261029396403046),
    (0.29341188341663044,0.15459858489173023),
    (0.29817501471105534,0.14350266208311094),
    (0.2980206274172146,0.13200996215882443),
    (0.29495919111822644,0.11948120309910538),
    (0.2884311226937778,0.10137842535299982),
    (0.27897311274457903,0.08684674787768815),
    (0.2642275681458787,0.07503547366765359),
    (0.25152976208139,0.0699367005013267),
    (0.23899875449112992,0.06920473741660342),
    (0.22514950603502057,0.07116251259796777),
    (0.2039438092571896,0.07763474841563581)],

    [(0.12269784997280163,0.19621245830392242),
    (0.12217293317374314,0.20749227373037166),
    (0.12531646739492616,0.21763672287332034),
    (0.13178371926497767,0.2278765309571665),
    (0.14204922610536166,0.2394718488579554),
    (0.1538052077100448,0.2475852729535486),
    (0.1687924781943882,0.25265590407818284),
    (0.18748769947564267,0.2544891469627522),
    (0.2040211445438291,0.25140559716261646),
    (0.22046259461444712,0.24373534604318467),
    (0.22864722807882787,0.23825548236008315),
    (0.23429663450571597,0.23172713065619627),
    (0.23678931651257798,0.22302147548503282),
    (0.23466661515702214,0.2097492672446181),
    (0.2274321363384277,0.19865175984164113),
    (0.2169671565111106,0.18705484849401213),
    (0.21054106868442832,0.17595098500863968),
    (0.19761904694457277,0.16678418632195147),
    (0.18121948682088446,0.16102495599785074),
    (0.16784671437989457,0.16020459644967297),
    (0.15617774382516333,0.16330147808837087),
    (0.14456361439917884,0.16942872381267496),
    (0.12688588859766975,0.1850789567073241)],

    [(0.07115858652200341,0.31514154092541585),
    (0.07384665166890894,0.32789042581361216),
    (0.08159625201473648,0.3380096630865575),
    (0.09327477439802588,0.3468618976620452),
    (0.10910239333590786,0.3546461687553686),
    (0.12524792262335455,0.3579095124739622),
    (0.1437673867181461,0.35859409264639863),
    (0.1644649598561167,0.3592713429633706),
    (0.18275935843722665,0.35731250105787166),
    (0.1952500518224322,0.3468618976620452),
    (0.19884706330934263,0.3361451886439222),
    (0.19863175323131543,0.3270185271126396),
    (0.19673512657243988,0.3173141525769966),
    (0.20110637617398966,0.30910949479732525),
    (0.20550209403701739,0.30124144381014245),
    (0.20729571321016296,0.29312571806911353),
    (0.20268964265927722,0.2811292410738472),
    (0.1918807792989018,0.2729660483219482),
    (0.17742913711737535,0.2673437304913418),
    (0.1509839392597894,0.26216061972476146),
    (0.12638366071111778,0.2642185563187497),
    (0.10169021863719503,0.2738616008560138),
    (0.07504738910902455,0.29811871292270514)],

    [(0.0497624153056447,0.44322279793259833),
    (0.04419296450019982,0.45517410956243026),
    (0.04224832197654262,0.468662141324854),
    (0.044479156405164096,0.4834788598824121),
    (0.049394444167853546,0.4950136090983123),
    (0.0568479156971723,0.5041055334884808),
    (0.06749736355367823,0.5121832466698908),
    (0.07662136934022731,0.5240325777019564),
    (0.0859766019682397,0.5322964408842199),
    (0.09889950010385733,0.5380212350516096),
    (0.11456953600173593,0.5416535856484405),
    (0.12895508554932805,0.5407467727567048),
    (0.1474737086582873,0.5341021702533503),
    (0.16712886657842985,0.5313448698412424),
    (0.18667962717309852,0.5237193414631227),
    (0.2021072732491507,0.5094214137867712),
    (0.20641775941119803,0.4931075633981153),
    (0.20272884145154366,0.47686386008035364),
    (0.19977459100999956,0.4586921214960015),
    (0.20235670079452092,0.4437247336872296),
    (0.20550269600582366,0.43040978566157045),
    (0.2031301953006349,0.41619489427055295),
    (0.19324218486915287,0.4014088761221141),
    (0.17960528976193407,0.3911146429761961),
    (0.1617599599102939,0.3833102236328279),
    (0.1369658385535242,0.37674717019775666),
    (0.11364534568696077,0.3760168403960445),
    (0.0884922384620816,0.38083375937380515),
    (0.0762270443621974,0.3852803613059267),
    (0.06666528331874326,0.3915806022421709),
    (0.05863069943180518,0.40076852295197285),
    (0.048524634652738007,0.42755135449001097)],

    [(0.04599455976002832,0.6324195753740368),
    (0.04670883115858528,0.6444267284631319),
    (0.0481006627109998,0.6562833893506619),
    (0.052314940093834895,0.6673970082716888),
    (0.06007780588460626,0.6767576232090277),
    (0.06934485008250159,0.6817476613334827),
    (0.08218739423496599,0.6861522316789554),
    (0.10852642427058909,0.6912807226288502),
    (0.13362931136255782,0.6909886615280249),
    (0.1604460390558778,0.6848346990117018),
    (0.1741686970130237,0.6777491720627268),
    (0.1836229358047009,0.6685510178832185),
    (0.19026844126126485,0.6558459350781599),
    (0.1928188060437385,0.6442962782818223),
    (0.19159233001091405,0.6335849161630961),
    (0.18756641574954358,0.6223773192884332),
    (0.18737139556128032,0.6074424023852695),
    (0.1861770540397312,0.5941513560622118),
    (0.17920427230717575,0.5814599414900484),
    (0.1666296573883916,0.5717199445650467),
    (0.15199807964868817,0.5668935003161752),
    (0.1347267978736762,0.5644000747007879),
    (0.11110396617416883,0.5628790057571589),
    (0.09004575175387153,0.5653057898847003),
    (0.0683770347342375,0.5730966472249628),
    (0.058473041145701024,0.5788712631635529),
    (0.051306111194403134,0.5858931584687131),
    (0.045996498453683775,0.5951975778474913),
    (0.042974597341294996,0.6201173159301554)],

    [(0.047603454181994145,0.7817224282175215),
    (0.04807897412900956,0.7915629893430983),
    (0.04902186088670855,0.8002835343897343),
    (0.052699907997920445,0.8093064802366913),
    (0.05998100841531145,0.8194864101292795),
    (0.06879103878074264,0.8270513875274754),
    (0.08072006871226053,0.8326965093528601),
    (0.10500691626748462,0.8389518150882136),
    (0.1279083503200668,0.8391757474841421),
    (0.15186929373407837,0.8326965093528601),
    (0.16454427809882388,0.8259006356294855),
    (0.1734153861668843,0.8169038223107061),
    (0.17961474421318532,0.8049660726839799),
    (0.1812295078310122,0.7946270813868199),
    (0.17938847476189124,0.7850552108084137),
    (0.17714236980105214,0.7743420781931984),
    (0.1771572950864544,0.7598933396259139),
    (0.17700963567927186,0.7469927940084699),
    (0.17082410521054991,0.7347961269751924),
    (0.15890946056300512,0.7263377570486474),
    (0.144976325983247,0.7228319615408503),
    (0.1287938641390398,0.7212926210734548),
    (0.10714101962042963,0.7201845027309199),
    (0.08789157982322371,0.7222632072487242),
    (0.06808352625253243,0.7292500821333321),
    (0.05902132407217309,0.7345338810352419),
    (0.052463542290397826,0.7409589419739605),
    (0.047605224678483146,0.7494725513909622),
    (0.04595928261748501,0.7703988284128993)]]

button_names = [
    11,
    12,
    13,
    14,
    15,
    16,
    17,
    18,
    21,
    22,
    23,
    24,
    25,
    26,
    27,
    28,
    31,
    32,
    33,
    34,
    35,
    36,
    37,
    38,
    41,
    42,
    43,
    44,
    45,
    46,
    47,
    48]

# slightly ugly use of the string representation of GL_LINE_TYPE.
#modified form zeffi's edge filet script
#not very efficient scaling and translating every time
def draw_polyline_2d_loop(context, points, scale, offset, color, LINE_TYPE):
    region = context.region
    rv3d = context.space_data.region_3d

    bgl.glColor4f(*color)  #black or white?

    if LINE_TYPE == "GL_LINE_STIPPLE":
        bgl.glLineStipple(4, 0x5555)
        bgl.glEnable(bgl.GL_LINE_STIPPLE)
        bgl.glColor4f(0.3, 0.3, 0.3, 1.0) #boring grey
    
    bgl.glBegin(bgl.GL_LINE_STRIP)
    for coord in points:
        bgl.glVertex2f(scale*coord[0]+offset[0], scale*coord[1] + offset[1])
    bgl.glVertex2f(scale*points[0][0]+offset[0], scale*points[0][1] + offset[1])
    bgl.glEnd()
    
    if LINE_TYPE == "GL_LINE_STIPPLE":
        bgl.glDisable(bgl.GL_LINE_STIPPLE)
        bgl.glEnable(bgl.GL_BLEND)  # back to uninterupted lines    
    return


def outside_loop(loop, scale, offset):    
    xs = [scale*v[0] + offset[0] for v in loop]
    ys = [scale*v[1] + offset[1]  for v in loop]
    
    maxx = max(xs)
    maxy = max(ys)
    
    bound = (1.1*maxx, 1.1*maxy)
    return bound

def point_inside_loop(loop, point, scale, offset):
        
    nverts = len(loop)
    
    #vectorize our two item tuple
    out = Vector(outside_loop(loop, scale, offset))
    pt = Vector(point)
    
    intersections = 0
    for i in range(0,nverts):
        a = scale*Vector(loop[i-1]) + Vector(offset)
        b = scale*Vector(loop[i]) + Vector(offset)
        if intersect_line_line_2d(pt,out,a,b):
            intersections += 1
    
    inside = False
    if fmod(intersections,2):
        inside = True
    
    return inside

def draw_callback_px(self, context):

    
    #draw all the buttons
    color = (1.0,1.0,1.0,1.0)
    for i in range(0,len(button_data)): #each of those is a loop        
        button = button_data[i]
        
        #draw it red if the button is selected or hovered
        if self.button_select[i] or self.button_hover[i]:
            color = (1.0,0.1,0.1,0.5)
        
        draw_polyline_2d_loop(context, button, self.menu_width, self.menu_loc, color,"GL_BLEND")
        color = (1.0,1.0,1.0,1.0)
    

class ButtonMultiSelect(bpy.types.Operator):
    '''Select Multiple Interestingly Shaped Buttons'''
    bl_idname = "view3d.button_multi_select"
    bl_label = "Button Multi Select"

    def modal(self, context, event):
        context.area.tag_redraw()

        if event.type == 'MOUSEMOVE':
            self.mouse = (event.mouse_region_x, event.mouse_region_y)
            for i in range(0,len(button_data)):
                self.button_hover[i] = point_inside_loop(button_data[i],self.mouse,self.menu_width, self.menu_loc)

        elif event.type == 'LEFTMOUSE':
            self.mouse = (event.mouse_region_x, event.mouse_region_y)
            for i in range(0,len(button_data)):
                self.button_hover[i] = point_inside_loop(button_data[i],self.mouse,self.menu_width, self.menu_loc)
                if self.button_hover[i]:
                    self.button_select[i] = True

            #no buttons are hovered, this is equiv to enter...
            if True not in self.button_hover:
                context.region.callback_remove(self._handle)
                self.ret_selected = [button_names[i] for i in range(0,len(button_data)) if self.button_select[i]]
                self.execute(context)
                return {'FINISHED'}
            

        elif event.type in {'RIGHTMOUSE', 'ESC'}:
            self.mouse = (event.mouse_region_x, event.mouse_region_y)
            for i in range(0,len(button_data)):
                self.button_hover[i] = point_inside_loop(button_data[i],self.mouse,self.menu_width, self.menu_loc)
                if self.button_hover[i]:
                    self.button_select[i] = False

            #no buttons are hovered, this is equiv to quiting...
            if True not in self.button_hover:
                context.region.callback_remove(self._handle)
                return {'CANCELLED'}

        return {'RUNNING_MODAL'}

    def invoke(self, context, event):
        if context.area.type == 'VIEW_3D':
            context.window_manager.modal_handler_add(self)

            # Add the region OpenGL drawing callback
            # draw in view space with 'POST_VIEW' and 'PRE_VIEW'
            self._handle = context.region.callback_add(draw_callback_px, (self, context), 'POST_PIXEL')

            self.mouse = (0,0)
            self.button_select = [False]*len(button_data)
            self.button_hover = [False]*len(button_data)
            
            region = bpy.context.region
            rv3d = bpy.context.space_data.region_3d
    
            width = region.width
            height = region.height
            mid = (width/2,height/2)
    
            #need to check height available..whatev
            #menu_width is also our scale!
            menu_aspect = 0.5824333739982135
            self.menu_width = .8*width
            self.menu_height = self.menu_width/menu_aspect
            if self.menu_height > height:
                self.menu_width = menu_aspect*.8*height
                self.menu_height = self.menu_width/menu_aspect
            #origin of menu is bottom left corner
            self.menu_loc = (.5*(width - self.menu_width), .5*(height - self.menu_height)) #for now
    

            return {'RUNNING_MODAL'}
        else:
            self.report({'WARNING'}, "View3D not found, cannot run operator")
            return {'CANCELLED'}
        
    def execute(self,context):       
        print(self.ret_selected)


def register():
    bpy.utils.register_class(ButtonMultiSelect)


def unregister():
    bpy.utils.unregister_class(ButtonMultiSelect)

if __name__ == "__main__":
    register()
